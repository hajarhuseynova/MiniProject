@model SmokeViewModel


<div class="detail_intro">
	<div class="container detail_intro_container">
		<div class="detail_left">
			<img src="~/assets/images/@Model.Product?.Image" />
		</div>
		<div class="detail_right">
			<h3>@Model.Product?.Title</h3>
			<p>@Model.Product?.Desc .</p>
			<p class="muted">Məhsul Kodu:@Model.Product?.ProductCode </p>
	         <div class="bools">
				@if (Model.Product.IsStock == true)
				{
					<p class="stock">stokda/</p>
				}

				@if (Model.Product.IsNew == true)
				{
					<p class="stock">yeni/</p>
				}

				@if (Model.Product.IsTrend == true)
				{
					<p class="stock">trend/</p>
				}

				@if (Model.Product.IsDiscount == true)
				{
					<p class="stock">endirim: @Model.Product.DiscountPercentage %</p>
				}
			</div>
			<div class="priceStar">
				@if (Model.Product.IsDiscount == true)
				{
					<p class="price">@(int.Parse(Model.Product.SellPrice)-int.Parse(Model.Product.SellPrice)*Model.Product.DiscountPercentage/100) AZN</p>
				}
				else
				{
					<p class="price">@Model.Product.SellPrice AZN</p>
				}
				<div class="stars">
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<p>137 rəy</p>
				</div>
			</div>
			<div class="line"></div>
			<div class="input_button_delete">
				<form action="detailp.html" class="input_number">
					<p class="minus" id="minus">-</p>
					<input type="number"
						   class="orangeinput specialJsInput"
						   id="countInput"
						   value="0" />
					<p class="pilus" id="pilus">+</p>
				</form>
				<a class="addbasketdetail" asp-action="addbasket" asp-controller="home" asp-route-id="@Model.Product.Id"
				><button class="addtobasket">Səbətə Əlavə Et</button></a>
			
			</div>
		</div>
	</div>
</div>
<div class="detail_info">
	<div class="container detail_info_container">
		<h1>Haqqında</h1>
		<p>
			@Model.Product.Info1
		</p>
		<p class="hide">
			@Model.Product.Info2
		</p>
	</div>
</div>
<div class="assesment">
        <div class="container assesment_container">
          <div class="left">
            <h3>@Model.Product.Title</h3>
            <h1>4.1</h1>
            <div class="stars">
              <span class="st">&#9733;</span>
              <span class="st">&#9733;</span>
              <span class="st">&#9733;</span>
              <span class="st">&#9733;</span>
            </div>
            <p>164 rəy</p>
          </div>
          <div class="middle">
            <div class="row">
              <span class="st">&#9733;</span>

              <p>5</p>
              <div class="hole">
                <div class="color" style="width: 200px"></div>
              </div>
            </div>
            <div class="row">
              <span class="st">&#9733;</span>

              <p>5</p>
              <div class="hole">
                <div class="color" style="width: 200px"></div>
              </div>
            </div>
            <div class="row">
              <span class="st">&#9733;</span>

              <p>5</p>
              <div class="hole">
                <div class="color" style="width: 200px"></div>
              </div>
            </div>
            <div class="row">
              <span class="st">&#9733;</span>

              <p>5</p>
              <div class="hole">
                <div class="color" style="width: 200px"></div>
              </div>
            </div>
            <div class="row">
              <span class="st">&#9733;</span>

              <p>5</p>
              <div class="hole">
                <div class="color" style="width: 200px"></div>
              </div>
            </div>
          </div>
          <div class="right">

          <form asp-controller="parfume" asp-action="addcomment" method="post">
            <input placeholder="Baslıq" type="text" />
            <textarea
              placeholder="Mətn daxil edin"
              rows="4"
              cols="40"
            ></textarea>
            <div class="right_bottom">
              <p>Reytinq</p>
              <div class="rating">
                <span class="star" data-value="1" id="star_1">&#9733;</span>
                <span class="star" data-value="1" id="star_2">&#9733;</span>
                <span class="star" data-value="1" id="star_3">&#9733;</span>
                <span class="star" data-value="1" id="star_4">&#9733;</span>
                <span class="star" data-value="1" id="star_5">&#9733;</span>
              </div>
              <a><button>Göndər</button></a>
          </form>

            </div>
          </div>
        </div>
</div>
<div class="comments_smoke">
	<div class="container comments_smoke_container">
		<div class="line_smoke"></div>
		<div class="comment_smoke">
			<div class="left">
				<h3>Hajar Huseynova</h3>
				<div class="left_stars">
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>

				</div>
			</div>
			<div class="middle">
				<h3>Best Product Ever!</h3>
				<p>
					Lorem ipsum dolor sit amet consectetur adipisicing elit. Enim
					veritatis distinctio saepe deleniti eligendi blanditiis quae
					adipisci eius vero harum. Error eaque eos corporis. Provident
					praesentium nostrum autem modi sunt?
				</p>
			</div>
			<div class="right">
				<p>15.04.2022</p>
				<div class="likes_smoke">
					<div class="lik">
						<img src="~/assets/icons/detail/like.svg"
							 class="like_image"
							 onclick="increaseLike(this)" />
						<p class="likeCount">5</p>
					</div>
					<div class="lik">
						<img src="~/assets/icons/detail/dislike.svg"
							 class="dislike_image"
							 onclick="decreaseDislike(this)" />
						<p class="dislikeCount">5</p>
					</div>
				</div>
			</div>
		</div>
		<div class="line_smoke"></div>
		<div class="comment_smoke">
			<div class="left">
				<h3>Hajar Huseynova</h3>
				<div class="left_stars">
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
					<span class="st">&#9733;</span>
				</div>
			</div>
			<div class="middle">
				<h3>Best Product Ever!</h3>
				<p>
					Lorem ipsum dolor sit amet consectetur adipisicing elit. Enim
					veritatis distinctio saepe deleniti eligendi blanditiis quae
					adipisci eius vero harum. Error eaque eos corporis. Provident
					praesentium nostrum autem modi sunt?
				</p>
			</div>
			<div class="right">
				<p>15.04.2022</p>
				<div class="likes_smoke">
					<div class="lik">
						<img src="~/assets/icons/detail/like.svg"
							 class="like_image"
							 onclick="increaseLike(this)" />
						<p class="likeCount">5</p>
					</div>
					<div class="lik">
						<img src="~/assets/icons/detail/dislike.svg"
							 class="dislike_image"
							 onclick="decreaseDislike(this)" />
						<p class="dislikeCount">5</p>
					</div>
				</div>
			</div>
		</div>
		<div class="line_smoke"></div>
	</div>
</div>
<div class="smokes">
	<div class="container smokes_container">
		<h1>Tüstülər</h1>
		<div class="newsmokes">
		@await Html.PartialAsync("_SmokePartialView",Model.Products.Where(x=>x.Category.Name=="Smoke").Take(4).ToList())
		</div>
	</div>
</div>
<div class="functions" style="margin-bottom:40px">
	<div class="container functions_container">
		@await Html.PartialAsync("_FunctionPartialView",Model.Functions.Take(4).ToList())
	</div>
</div>

<script>
			const addbasketdetail=document.querySelector(".addbasketdetail");
			const specialJsInput=document.querySelector(".specialJsInput");
        	const totalPriceElement = document.getElementById("totalPrice");	

	 addbasketdetail.addEventListener("click", (e) => {
			e.preventDefault();

			let href = addbasketdetail.getAttribute("href");
			href=href+`?count=${specialJsInput.value}`
			let TotalPrice = 0;
			
			fetch(href)
				.then(x => x.json())
				.then(x => {
				 if(x.status==200){
					 fetch("/home/getallbaskets")
					 .then(res=>res.json())
					 .then(b=>{
							basketItems.innerHTML=""
					b.forEach(basket => {
						TotalPrice += basket.price*basket.count;
							let basketView=`
											<div class="basketItem unvis">
											<div class="item_left">
												<img src="/assets/images/${basket.image}" />
											</div>
											<div class="item_right">
												<div class="spans">
													<span>${basket.name}</span>
												
													<span>${basket.count} * ${basket.price} AZN</span>
												</div>
												<div class="deleteimage">
													<a href="/home/RemoveBasket/${basket.productId}" data-id="">
														<i class="fa-solid fa-x"></i>
													</a>
												</div>
											</div>
										</div>
										`
						basketItems.innerHTML += basketView;

					})
				
					totalPriceElement.innerHTML = TotalPrice;
					
					 const Toast = Swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'success',
                        title: `Əlavə edildi!`
                    })



					 })
				 }

				})
	  })
</script>


<script>
    const products = document.querySelectorAll(".add-basket-product");
    products.forEach(prod => {
        prod.addEventListener("click", (e) => {
            e.preventDefault();
            let href = prod.getAttribute("href");
            let TotalPrice = 0;

            fetch(href)
                .then(x => x.json())
                .then(x => {
                 if(x.status==200){
                     fetch("/home/getallbaskets")
                     .then(res=>res.json())
                     .then(b=>{
                            basketItems.innerHTML=""
                    b.forEach(basket => {
                     
                        TotalPrice += basket.price*basket.count;
                            let basketView=`
								<div class="basketItem unvis">
											<div class="item_left">
												<img src="/assets/images/${basket.image}" />
											</div>
											<div class="item_right">
												<div class="spans">
													<span>${basket.name}</span>
											
													<span>${basket.count} * ${basket.price} AZN</span>
												</div>
												<div class="deleteimage">
													<a href="/parfume/RemoveBasket/${basket.productId}" data-id="">
														<i class="fa-solid fa-x"></i>
													</a>
												</div>
											</div>
										</div>
                                    `
                        basketItems.innerHTML += basketView;

                    })
                
                    totalPriceElement.innerHTML = TotalPrice;
                 


                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    Toast.fire({
                        icon: 'success',
                        title: `Elave edildi!`
                    })

                     })
                 }

                })
        })
    })

</script>